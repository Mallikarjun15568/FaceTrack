{% extends "base.html" %}
{% block content %}


<div class="max-w-3xl mx-auto space-y-8">

    <!-- Header -->
    <div class="flex items-center justify-between mb-6 scroll-reveal">
        <h2 class="text-2xl font-bold flex items-center gap-2">
            <i class="fa-solid fa-user-plus text-blue-600"></i>
            Add New Employee
        </h2>

        <a href="{{ url_for('employees.list_employees') }}"
           class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-white hover:bg-gray-300 hover:dark:bg-gray-600 transition">
            <i class="fa-solid fa-arrow-left"></i> Back
        </a>
    </div>

    <!-- Add Employee Card -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-8 scroll-reveal" style="transition-delay:0.1s">

          <form action="{{ url_for('employees.add_employee') }}"
              method="POST"
              enctype="multipart/form-data"
              class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- Full Name -->
            <div class="scroll-reveal" style="transition-delay:0.15s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-user text-blue-600 text-sm"></i>
                    Full Name
                </label>
                <input name="full_name" required type="text" placeholder="Enter full name"
                       class="input-modern" />
            </div>

            <!-- Email -->
            <div class="scroll-reveal" style="transition-delay:0.18s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-envelope text-blue-600 text-sm"></i>
                    Email
                </label>
                <input name="email" required type="email" placeholder="employee@company.com"
                       class="input-modern" />
            </div>

            <!-- Phone with Country Code -->
            <div class="scroll-reveal" style="transition-delay:0.21s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-phone text-blue-600 text-sm"></i>
                    Phone
                </label>
                <div class="flex gap-3">
                    <select name="country_code" id="country_code" class="input-modern w-24 shrink-0" aria-label="Country code">
                        <option value="+91" title="India">+91 India</option>
                        <option value="+1" title="United States">+1 United States</option>
                        <option value="+44" title="United Kingdom">+44 United Kingdom</option>
                        <option value="+61" title="Australia">+61 Australia</option>
                        <option value="+966" title="Saudi Arabia">+966 Saudi Arabia</option>
                    </select>
                          <input name="phone" id="phoneInput" type="text" inputmode="numeric" maxlength="10" minlength="10" pattern="\d{10}"
                              placeholder="Enter 10 digit number" title="Enter 10 digit phone number" class="input-modern flex-1" />
                </div>
                <p class="text-xs text-gray-500 mt-1">Enter phone digits only (no spaces or symbols).</p>
            </div>

            <!-- Gender -->
            <div class="scroll-reveal" style="transition-delay:0.24s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-venus-mars text-blue-600 text-sm"></i>
                    Gender
                </label>
                <select name="gender" class="input-modern">
                    <option>Male</option>
                    <option>Female</option>
                    <option>Other</option>
                </select>
            </div>

            <!-- Department -->
            <div class="scroll-reveal" style="transition-delay:0.27s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-building text-blue-600 text-sm"></i>
                    Department
                </label>
                <select name="department_id" class="input-modern">
                    {% for dept in departments %}
                    <option value="{{ dept.id }}">{{ dept.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Job Title -->
            <div class="scroll-reveal" style="transition-delay:0.30s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-briefcase text-blue-600 text-sm"></i>
                    Job Title
                </label>
                <input name="job_title" type="text" placeholder="e.g., Software Engineer"
                       class="input-modern" />
            </div>

            <!-- Joining Date -->
            <div class="scroll-reveal" style="transition-delay:0.33s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-calendar text-blue-600 text-sm"></i>
                    Joining Date
                </label>
                <input name="join_date" type="date"
                       class="input-modern" />
            </div>

            <!-- Status -->
            <div class="scroll-reveal" style="transition-delay:0.36s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-toggle-on text-blue-600 text-sm"></i>
                    Status
                </label>
                <select name="status" class="input-modern">
                    <option value="Active">Active</option>
                    <option value="Inactive">Inactive</option>
                </select>
            </div>

            <!-- Photo Upload -->
            <div class="col-span-1 md:col-span-2 scroll-reveal" style="transition-delay:0.39s">
                <label class="block font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-camera text-blue-600 text-sm"></i>
                    Upload Employee Photo
                </label>
                <input name="photo" type="file" accept="image/*"
                       class="input-modern file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-600 file:font-semibold hover:file:bg-blue-100 cursor-pointer" />
            </div>

            <!-- Submit Button -->
            <div class="col-span-1 md:col-span-2 flex justify-end gap-3 scroll-reveal" style="transition-delay:0.42s">
                <a href="{{ url_for('employees.list_employees') }}" class="btn-secondary">
                    Cancel
                </a>
                <button type="submit" class="btn-primary flex items-center gap-2">
                    <i class="fa-solid fa-save"></i>
                    Save Employee
                </button>
            </div>

        </form>

    </div>

</div>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const phoneInput = document.getElementById('phoneInput');
    if (!phoneInput) return;

    // allow only digits while typing
    phoneInput.addEventListener('input', function(e) {
        const max = this.maxLength || 10;
        let cleaned = this.value.replace(/\D+/g, '');
        if (cleaned.length > max) cleaned = cleaned.slice(0, max);
        if (this.value !== cleaned) this.value = cleaned;
    });

    // sanitize pasted content
    phoneInput.addEventListener('paste', function(e) {
        e.preventDefault();
        const text = (e.clipboardData || window.clipboardData).getData('text') || '';
        const max = this.maxLength || 10;
        const cleaned = text.replace(/\D+/g, '').slice(0, max);
        const start = this.selectionStart || 0;
        const end = this.selectionEnd || 0;
        const newVal = this.value.slice(0, start) + cleaned + this.value.slice(end);
        this.value = newVal.replace(/\D+/g, '').slice(0, max);
    });
});
</script>
{% endblock %}
